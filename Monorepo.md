ğŸ“‹ Tá»•ng quan dá»± Ã¡n Datban Server lÃ  má»™t microservice API Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng NestJS vá»›i kiáº¿n trÃºc Onion Architecture, Domain-Driven Design (DDD) vÃ  Ports and Adapters. ÄÃ¢y lÃ  má»™t boilerplate template cho viá»‡c phÃ¡t triá»ƒn microservice vá»›i Ä‘áº§y Ä‘á»§ cÃ¡c tÃ­nh nÄƒng enterprise. ğŸ—ï¸ Kiáº¿n trÃºc vÃ  Design Patterns 1. Onion Architecture Core Layer: Chá»©a business logic, entities, use cases vÃ  repository interfaces Infrastructure Layer: Implementations cá»§a cÃ¡c ports (database, cache, email, etc.) Application Layer: Controllers vÃ  adapters Presentation Layer: HTTP endpoints vÃ  Swagger documentation 2. Design Patterns Ä‘Æ°á»£c sá»­ dá»¥ng Repository Pattern: Generic repository cho cáº£ MongoDB vÃ  PostgreSQL Use Case Pattern: Business logic Ä‘Æ°á»£c tÃ¡ch biá»‡t trong cÃ¡c use case Adapter Pattern: Controllers sá»­ dá»¥ng adapters Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i use cases Dependency Inversion: Core khÃ´ng phá»¥ thuá»™c vÃ o infrastructure Factory Pattern: Cho viá»‡c táº¡o cÃ¡c service instances ğŸ—‚ï¸ Cáº¥u trÃºc thÆ° má»¥c Apply to redis-auth-t... Utilities ï¿½ï¿½ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng Backend Framework NestJS (v11.0.10) - Node.js framework TypeScript (5.7.3) - Type safety SWC - Fast TypeScript compiler Databases MongoDB (v4.2.20) vá»›i Mongoose PostgreSQL vá»›i TypeORM Redis - Caching Authentication & Authorization JWT tokens Role-based access control (RBAC) Permission-based authorization Infrastructure & DevOps Docker & Docker Compose PM2 - Process management OpenTelemetry - Observability Prometheus - Metrics Grafana - Monitoring Zipkin - Distributed tracing Loki - Log aggregation Testing Jest - Testing framework Testcontainers - Integration testing 100% test coverage target Code Quality ESLint - Linting Prettier - Code formatting Husky - Git hooks Commitlint - Commit message validation ğŸš€ TÃ­nh nÄƒng chÃ­nh 1. CRUD Operations Generic CRUD cho cáº£ MongoDB vÃ  PostgreSQL Search, pagination, sorting Entity validation vá»›i Zod Logical deletion 2. Authentication & Authorization Login/Logout Password reset vá»›i email Refresh token Role-based permissions 3. Observability Tracing: OpenTelemetry vá»›i Zipkin Metrics: Prometheus integration Logging: Structured logging vá»›i Pino Health checks: Application health monitoring 4. Infrastructure Services Email Service: Nodemailer vá»›i Handlebars templates Cache Service: Redis vÃ  NodeCache HTTP Service: Axios vá»›i retry logic Logger Service: MongoDB transport 5. Development Tools CRUD Scaffolding: Tá»± Ä‘á»™ng táº¡o CRUD operations Swagger Documentation: API documentation Database Migrations: Cho cáº£ MongoDB vÃ  PostgreSQL Hot reload: Development mode ğŸ”§ Scripts vÃ  Commands Apply to redis-auth-t... code ğŸ“Š Monitoring & Observability Dá»± Ã¡n cÃ³ Ä‘áº§y Ä‘á»§ stack observability: Grafana (port 9600) - Dashboards Prometheus (port 9620) - Metrics collection Zipkin (port 9610) - Distributed tracing Mongo Express (port 9820) - MongoDB admin PgAdmin (port 9810) - PostgreSQL admin ï¿½ï¿½ Äiá»ƒm máº¡nh Kiáº¿n trÃºc sáº¡ch: Onion Architecture Ä‘áº£m báº£o separation of concerns Type Safety: TypeScript vá»›i Zod validation Test Coverage: 100% test coverage target Observability: Äáº§y Ä‘á»§ monitoring stack Scalability: Microservice-ready architecture Developer Experience: Scaffolding tools vÃ  hot reload Multi-database: Há»— trá»£ cáº£ MongoDB vÃ  PostgreSQL Production Ready: Docker, PM2, security headers ï¿½ï¿½ Káº¿t luáº­n ÄÃ¢y lÃ  má»™t boilerplate template ráº¥t cháº¥t lÆ°á»£ng cho viá»‡c phÃ¡t triá»ƒn microservice vá»›i NestJS. Dá»± Ã¡n thá»ƒ hiá»‡n best practices trong viá»‡c: Tá»• chá»©c code theo Clean Architecture Implement cÃ¡c design patterns phÃ¹ há»£p Setup observability vÃ  monitoring Äáº£m báº£o code quality vÃ  testing Chuáº©n bá»‹ cho production deployment Template nÃ y phÃ¹ há»£p cho cÃ¡c dá»± Ã¡n enterprise cáº§n scalability, maintainability vÃ  observability cao.

Task: Refactor the existing NestJS boilerplate for the "DatBan" restaurant reservation system into a microservices architecture using event-driven architecture with RabbitMQ for async communication, gRPC for sync communication, Kong as the API Gateway, and PostgreSQL, MongoDB, and Redis as data stores. Preserve all original best practices (Onion Architecture, DDD, Ports & Adapters, 100% test coverage, observability)
